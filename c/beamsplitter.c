#include "beamsplitter.h"
#include <stdint.h>

typedef uint8_t sbox_t[8][256];

const sbox_t S[4] = {
    {
        {57,  191, 149, 181, 190, 120, 196, 66,  180, 17,  67,  128, 231, 207,
         83,  96,  106, 51,  27,  7,   92,  204, 40,  2,   45,  84,  28,  223,
         32,  1,   5,   90,  171, 142, 144, 118, 24,  221, 44,  46,  244, 42,
         159, 177, 220, 203, 253, 77,  184, 124, 123, 230, 209, 25,  186, 16,
         113, 33,  88,  112, 80,  228, 217, 254, 182, 161, 153, 218, 211, 166,
         183, 157, 72,  176, 94,  56,  158, 179, 13,  38,  227, 129, 187, 41,
         156, 236, 246, 219, 114, 195, 229, 121, 3,   122, 62,  50,  136, 104,
         197, 189, 213, 85,  115, 108, 86,  134, 160, 252, 242, 188, 79,  9,
         52,  74,  21,  245, 165, 8,   97,  54,  91,  139, 6,   119, 155, 39,
         29,  71,  18,  240, 247, 148, 163, 194, 131, 174, 130, 12,  140, 70,
         109, 255, 170, 126, 75,  202, 132, 95,  154, 137, 14,  102, 138, 125,
         55,  210, 222, 15,  216, 117, 135, 60,  151, 98,  100, 20,  127, 69,
         226, 64,  167, 22,  19,  193, 198, 61,  162, 133, 232, 147, 235, 35,
         76,  208, 68,  48,  0,   225, 116, 82,  89,  63,  185, 212, 58,  10,
         201, 206, 99,  248, 30,  65,  233, 141, 164, 146, 34,  150, 249, 59,
         26,  111, 145, 238, 241, 169, 178, 81,  11,  175, 101, 250, 4,   47,
         73,  234, 172, 224, 237, 37,  78,  107, 251, 215, 192, 43,  143, 105,
         49,  239, 110, 168, 205, 23,  53,  36,  103, 173, 31,  243, 87,  152,
         214, 199, 93,  200},
        {130, 114, 19,  126, 18,  214, 206, 222, 253, 7,   216, 148, 38,  170,
         73,  159, 56,  125, 156, 197, 176, 27,  95,  215, 157, 117, 123, 86,
         249, 44,  14,  201, 42,  65,  210, 83,  88,  62,  5,   229, 87,  46,
         220, 76,  10,  82,  102, 212, 217, 219, 207, 124, 178, 91,  24,  75,
         15,  45,  60,  59,  22,  0,   104, 70,  165, 198, 172, 13,  248, 135,
         250, 121, 94,  136, 189, 29,  112, 224, 146, 155, 8,   69,  25,  53,
         35,  37,  49,  61,  184, 99,  254, 142, 152, 151, 118, 93,  195, 166,
         137, 16,  194, 111, 109, 64,  252, 122, 199, 228, 47,  36,  48,  161,
         147, 31,  133, 183, 1,   101, 119, 169, 132, 6,   51,  128, 20,  43,
         77,  188, 63,  204, 116, 196, 138, 208, 103, 175, 221, 150, 237, 23,
         90,  71,  80,  105, 153, 200, 33,  11,  241, 72,  84,  97,  21,  247,
         243, 227, 233, 218, 134, 171, 39,  120, 108, 231, 113, 67,  191, 127,
         115, 131, 149, 187, 225, 154, 186, 26,  139, 54,  85,  173, 144, 34,
         58,  68,  17,  12,  209, 40,  179, 100, 163, 240, 92,  4,   238, 168,
         164, 30,  211, 181, 174, 223, 245, 55,  32,  89,  213, 239, 242, 74,
         251, 145, 236, 57,  203, 96,  226, 234, 106, 129, 110, 160, 2,   235,
         9,   162, 167, 79,  246, 107, 244, 50,  192, 28,  202, 232, 41,  143,
         177, 66,  185, 193, 3,   98,  141, 182, 190, 230, 158, 255, 180, 140,
         52,  205, 81,  78},
        {63,  1,   203, 93,  151, 24,  49,  171, 61,  55,  156, 39,  88,  177,
         96,  7,   186, 145, 80,  112, 59,  219, 194, 84,  32,  191, 178, 31,
         25,  34,  207, 165, 53,  70,  2,   54,  97,  72,  140, 253, 28,  123,
         200, 161, 150, 154, 4,   128, 73,  78,  190, 172, 127, 17,  125, 231,
         142, 246, 181, 218, 234, 212, 119, 216, 102, 159, 42,  12,  229, 167,
         182, 213, 143, 131, 30,  241, 10,  217, 220, 22,  138, 215, 157, 183,
         47,  16,  13,  155, 248, 206, 148, 113, 254, 87,  19,  104, 68,  193,
         38,  144, 135, 158, 45,  162, 197, 173, 225, 40,  15,  69,  89,  6,
         129, 81,  27,  101, 176, 174, 201, 160, 196, 58,  18,  136, 95,  77,
         179, 115, 245, 62,  41,  226, 214, 114, 120, 124, 110, 239, 251, 163,
         130, 195, 60,  46,  164, 66,  230, 180, 146, 205, 106, 65,  185, 198,
         90,  227, 33,  57,  153, 48,  0,   37,  247, 74,  139, 192, 249, 111,
         23,  204, 56,  118, 238, 75,  76,  211, 202, 126, 36,  43,  79,  26,
         221, 228, 237, 188, 9,   240, 44,  85,  91,  141, 210, 99,  8,   133,
         134, 3,   175, 166, 233, 35,  243, 108, 105, 52,  232, 11,  29,  98,
         209, 103, 92,  149, 67,  208, 244, 5,   168, 170, 50,  20,  223, 189,
         252, 255, 199, 116, 86,  82,  94,  152, 184, 147, 236, 71,  14,  235,
         169, 64,  51,  107, 132, 121, 224, 222, 250, 122, 83,  187, 100, 109,
         242, 21,  117, 137},
        {142, 0,   208, 6,   169, 123, 70,  131, 78,  41,  182, 7,   95,  191,
         55,  5,   110, 132, 238, 25,  81,  35,  244, 74,  36,  76,  241, 178,
         20,  187, 234, 156, 164, 193, 154, 166, 104, 96,  229, 190, 58,  8,
         217, 201, 103, 14,  145, 249, 40,  146, 167, 107, 109, 161, 202, 54,
         38,  235, 223, 168, 121, 115, 111, 186, 68,  88,  90,  31,  199, 242,
         245, 59,  228, 77,  2,   147, 66,  30,  189, 252, 237, 83,  218, 144,
         34,  75,  160, 207, 105, 204, 51,  60,  128, 10,  130, 206, 102, 86,
         148, 220, 158, 73,  134, 17,  120, 192, 24,  157, 200, 194, 72,  52,
         114, 253, 246, 177, 108, 153, 197, 174, 227, 139, 203, 159, 195, 129,
         135, 219, 79,  50,  213, 255, 47,  11,  69,  85,  247, 1,   136, 112,
         48,  21,  248, 214, 236, 133, 61,  26,  124, 250, 210, 230, 71,  127,
         113, 65,  18,  19,  143, 9,   222, 150, 15,  16,  151, 57,  118, 29,
         98,  4,   33,  27,  42,  196, 39,  170, 181, 198, 185, 100, 141, 125,
         163, 221, 12,  44,  22,  176, 233, 97,  180, 212, 117, 183, 49,  226,
         89,  62,  216, 209, 184, 92,  63,  254, 152, 215, 93,  91,  205, 101,
         239, 13,  80,  122, 225, 116, 155, 173, 224, 126, 188, 45,  171, 240,
         67,  23,  140, 232, 149, 251, 64,  3,   32,  84,  106, 162, 137, 43,
         165, 211, 87,  46,  53,  172, 243, 56,  138, 179, 28,  37,  231, 119,
         99,  94,  82,  175},
        {219, 28,  40,  107, 181, 10,  248, 58,  121, 85,  1,   83,  241, 109,
         6,   144, 55,  250, 187, 183, 39,  204, 123, 71,  220, 88,  225, 179,
         188, 18,  36,  162, 0,   76,  53,  101, 54,  237, 110, 82,  103, 89,
         207, 113, 79,  60,  249, 167, 151, 148, 38,  235, 203, 205, 125, 65,
         30,  3,   133, 178, 253, 143, 165, 2,   7,   37,  19,  11,  177, 29,
         173, 62,  69,  169, 48,  91,  152, 194, 198, 22,  184, 72,  245, 202,
         175, 32,  211, 172, 239, 57,  233, 66,  234, 35,  206, 189, 108, 146,
         164, 195, 209, 100, 127, 27,  240, 106, 157, 78,  161, 145, 96,  124,
         67,  212, 247, 230, 216, 200, 221, 214, 90,  98,  50,  150, 77,  15,
         74,  68,  117, 46,  228, 141, 231, 116, 95,  73,  242, 137, 156, 26,
         166, 186, 23,  190, 87,  120, 176, 193, 180, 223, 56,  254, 122, 128,
         255, 252, 135, 154, 84,  208, 196, 170, 199, 86,  34,  213, 4,   93,
         136, 81,  159, 246, 16,  43,  115, 217, 222, 9,   153, 210, 112, 41,
         44,  129, 226, 149, 134, 191, 14,  59,  63,  114, 243, 218, 130, 142,
         33,  70,  201, 155, 244, 13,  5,   238, 160, 236, 185, 64,  132, 229,
         17,  75,  174, 45,  8,   197, 92,  232, 131, 80,  168, 215, 94,  104,
         42,  97,  52,  192, 20,  224, 51,  158, 99,  126, 118, 147, 182, 12,
         61,  21,  138, 105, 24,  47,  227, 31,  119, 251, 111, 49,  171, 25,
         140, 139, 102, 163},
        {116, 209, 232, 35,  139, 128, 105, 1,   46,  225, 255, 235, 213, 250,
         51,  172, 8,   4,   169, 11,  246, 3,   125, 234, 73,  114, 245, 94,
         16,  34,  22,  244, 7,   122, 37,  220, 83,  176, 217, 146, 10,  199,
         54,  52,  195, 109, 66,  29,  108, 61,  74,  180, 92,  86,  12,  67,
         5,   242, 18,  201, 248, 130, 149, 148, 41,  181, 33,  224, 230, 167,
         0,   64,  27,  140, 100, 88,  252, 28,  200, 48,  214, 101, 63,  187,
         161, 21,  24,  15,  166, 127, 228, 193, 185, 165, 43,  137, 117, 154,
         49,  69,  205, 183, 93,  121, 6,   189, 240, 99,  87,  124, 222, 143,
         210, 23,  55,  118, 236, 89,  206, 85,  113, 76,  239, 218, 26,  132,
         157, 112, 17,  202, 150, 207, 179, 153, 226, 68,  170, 216, 57,  120,
         174, 60,  141, 84,  159, 110, 197, 192, 168, 191, 115, 152, 25,  44,
         156, 9,   188, 198, 62,  136, 82,  119, 50,  131, 144, 39,  253, 75,
         254, 91,  45,  20,  135, 249, 173, 215, 145, 38,  96,  104, 151, 243,
         72,  31,  231, 134, 19,  59,  56,  80,  40,  186, 178, 77,  147, 42,
         70,  158, 194, 204, 123, 221, 241, 162, 65,  247, 171, 71,  208, 2,
         36,  219, 13,  90,  79,  14,  133, 237, 30,  223, 106, 177, 111, 126,
         238, 107, 233, 203, 227, 97,  102, 32,  164, 47,  251, 81,  95,  163,
         98,  212, 78,  175, 160, 142, 53,  138, 190, 184, 196, 155, 182, 129,
         103, 58,  211, 229},
        {238, 91,  206, 69,  149, 205, 125, 176, 36,  225, 249, 144, 39,  162,
         67,  236, 35,  164, 3,   61,  204, 109, 53,  142, 83,  190, 197, 171,
         224, 121, 7,   168, 79,  24,  253, 146, 209, 52,  243, 63,  19,  155,
         246, 84,  97,  112, 43,  178, 159, 193, 213, 2,   76,  59,  172, 128,
         160, 161, 66,  254, 150, 175, 107, 137, 117, 31,  180, 145, 203, 1,
         210, 235, 41,  237, 124, 15,  136, 140, 196, 101, 85,  42,  177, 189,
         153, 141, 34,  156, 27,  242, 214, 30,  227, 99,  252, 228, 217, 173,
         221, 58,  179, 208, 12,  188, 166, 157, 163, 127, 187, 240, 138, 212,
         191, 103, 170, 28,  38,  239, 181, 54,  111, 241, 68,  247, 108, 130,
         71,  57,  152, 199, 148, 114, 98,  11,  232, 74,  0,   33,  123, 182,
         81,  87,  80,  154, 118, 45,  70,  8,   231, 105, 62,  90,  48,  110,
         131, 186, 234, 251, 194, 49,  248, 198, 116, 165, 100, 10,  37,  143,
         106, 122, 229, 158, 89,  55,  133, 78,  119, 185, 75,  9,   13,  222,
         23,  174, 47,  46,  169, 40,  151, 134, 192, 17,  93,  244, 65,  201,
         211, 233, 226, 147, 72,  126, 26,  129, 4,   104, 216, 6,   21,  60,
         51,  120, 95,  73,  32,  16,  223, 135, 77,  29,  44,  245, 113, 215,
         20,  250, 220, 195, 200, 5,   167, 25,  64,  218, 132, 18,  92,  102,
         88,  230, 14,  255, 96,  22,  82,  86,  207, 219, 202, 183, 94,  184,
         56,  115, 50,  139},
        {100, 54,  91,  51,  252, 2,   11,  113, 79,  215, 55,  102, 60,  76,
         249, 158, 85,  204, 73,  243, 58,  7,   86,  131, 59,  150, 71,  120,
         224, 223, 78,  0,   72,  145, 45,  154, 134, 137, 107, 44,  248, 65,
         228, 233, 20,  142, 169, 227, 63,  130, 230, 52,  181, 111, 187, 64,
         179, 226, 202, 205, 103, 220, 166, 119, 151, 10,  157, 225, 159, 191,
         53,  203, 117, 194, 152, 139, 177, 41,  94,  21,  171, 232, 127, 255,
         69,  50,  4,   115, 218, 35,  42,  141, 80,  217, 198, 209, 121, 183,
         23,  216, 184, 186, 57,  99,  189, 229, 17,  110, 206, 153, 98,  47,
         24,  161, 222, 235, 170, 66,  6,   250, 144, 197, 82,  160, 16,  18,
         192, 109, 165, 81,  214, 33,  26,  62,  67,  155, 90,  190, 43,  22,
         240, 48,  96,  13,  28,  114, 182, 180, 246, 15,  128, 221, 172, 254,
         231, 37,  29,  135, 5,   245, 237, 122, 112, 132, 162, 236, 136, 19,
         156, 30,  12,  188, 149, 97,  143, 125, 34,  40,  93,  175, 124, 88,
         238, 133, 140, 83,  211, 168, 95,  199, 219, 104, 39,  92,  38,  106,
         167, 126, 84,  8,   253, 164, 207, 87,  147, 210, 31,  234, 25,  213,
         75,  247, 196, 239, 3,   174, 244, 74,  14,  208, 116, 173, 9,   148,
         146, 241, 61,  56,  108, 105, 77,  251, 68,  163, 212, 89,  32,  27,
         200, 123, 242, 185, 195, 36,  178, 70,  101, 49,  129, 118, 176, 193,
         201, 138, 1,   46},
    },
    {
        {105, 111, 166, 24,  192, 197, 213, 25,  206, 163, 245, 78,  97,  121,
         55,  212, 153, 16,  140, 49,  251, 167, 204, 72,  15,  162, 142, 211,
         82,  61,  80,  253, 52,  63,  62,  158, 184, 202, 229, 43,  131, 241,
         156, 59,  110, 102, 188, 135, 108, 128, 151, 122, 136, 26,  21,  127,
         195, 51,  37,  230, 71,  87,  60,  149, 118, 85,  1,   234, 6,   74,
         92,  185, 194, 159, 238, 141, 100, 215, 152, 28,  2,   174, 95,  248,
         23,  186, 223, 64,  237, 233, 246, 181, 214, 9,   18,  146, 114, 58,
         113, 130, 120, 191, 236, 254, 157, 244, 179, 39,  231, 217, 107, 173,
         193, 31,  171, 242, 137, 90,  183, 164, 106, 175, 116, 10,  125, 133,
         161, 225, 96,  243, 227, 172, 255, 132, 8,   45,  27,  200, 168, 13,
         33,  83,  155, 38,  220, 169, 40,  198, 252, 177, 41,  203, 54,  46,
         134, 79,  139, 19,  42,  170, 154, 91,  93,  145, 239, 208, 3,   104,
         4,   240, 7,   143, 209, 129, 22,  150, 44,  126, 201, 224, 20,  67,
         48,  29,  182, 210, 94,  250, 66,  178, 160, 56,  70,  77,  189, 88,
         17,  180, 81,  68,  65,  222, 115, 218, 199, 32,  249, 86,  35,  109,
         112, 235, 50,  14,  53,  196, 144, 98,  76,  124, 123, 30,  73,  117,
         99,  190, 148, 205, 207, 232, 221, 5,   176, 12,  69,  138, 228, 165,
         57,  84,  226, 34,  103, 187, 101, 89,  119, 47,  75,  11,  247, 36,
         216, 219, 0,   147},
        {209, 214, 25,  168, 79,  163, 70,  4,   109, 98,  166, 74,  92,  129,
         210, 195, 145, 7,   161, 34,  176, 59,  72,  153, 13,  30,  47,  199,
         103, 67,  244, 248, 197, 71,  222, 155, 121, 227, 87,  196, 234, 27,
         116, 159, 68,  53,  15,  120, 233, 230, 31,  58,  207, 217, 26,  22,
         239, 51,  170, 246, 89,  141, 45,  211, 226, 115, 82,  105, 251, 19,
         200, 203, 202, 88,  118, 113, 91,  50,  160, 174, 245, 128, 104, 76,
         127, 136, 179, 99,  132, 42,  206, 192, 32,  138, 44,  33,  243, 133,
         114, 154, 10,  125, 93,  225, 224, 149, 194, 60,  111, 241, 219, 182,
         164, 221, 69,  61,  41,  181, 6,   124, 110, 190, 169, 123, 208, 106,
         184, 16,  213, 198, 18,  232, 144, 130, 20,  43,  63,  151, 64,  14,
         12,  107, 55,  255, 215, 77,  29,  3,   240, 56,  131, 185, 83,  78,
         146, 86,  175, 46,  134, 126, 147, 119, 193, 254, 40,  171, 1,   38,
         238, 148, 52,  156, 205, 108, 97,  191, 9,   5,   81,  143, 172, 218,
         54,  250, 142, 49,  90,  204, 21,  201, 37,  80,  36,  11,  188, 157,
         39,  73,  96,  223, 24,  102, 140, 117, 23,  139, 66,  48,  75,  177,
         162, 8,   65,  122, 178, 253, 212, 249, 57,  28,  183, 220, 95,  236,
         85,  94,  35,  17,  187, 242, 137, 158, 189, 173, 165, 167, 84,  216,
         100, 112, 135, 228, 2,   101, 62,  247, 152, 180, 186, 0,   150, 231,
         252, 237, 235, 229},
        {183, 242, 190, 65,  126, 229, 124, 108, 131, 241, 66,  222, 207, 171,
         164, 61,  105, 34,  74,  86,  115, 165, 128, 106, 158, 44,  193, 220,
         180, 225, 218, 43,  209, 177, 20,  98,  182, 144, 99,  26,  254, 156,
         4,   1,   251, 174, 255, 134, 47,  206, 152, 145, 46,  157, 6,   9,
         196, 90,  248, 238, 97,  141, 179, 54,  213, 15,  178, 24,  246, 201,
         142, 147, 63,  69,  29,  32,  236, 163, 151, 245, 175, 181, 161, 135,
         169, 94,  39,  150, 200, 57,  149, 104, 118, 93,  191, 17,  109, 75,
         194, 48,  16,  143, 186, 119, 70,  3,   198, 62,  252, 76,  168, 45,
         64,  247, 111, 84,  230, 36,  8,   73,  195, 133, 71,  125, 127, 78,
         188, 249, 37,  91,  172, 25,  138, 227, 226, 215, 216, 121, 132, 103,
         155, 244, 129, 214, 101, 234, 81,  140, 50,  22,  87,  137, 68,  102,
         56,  184, 159, 203, 31,  30,  250, 167, 189, 89,  187, 19,  2,   208,
         95,  0,   116, 55,  204, 219, 49,  205, 51,  23,  113, 136, 233, 79,
         52,  80,  100, 59,  107, 232, 148, 199, 123, 60,  41,  212, 197, 114,
         117, 92,  176, 243, 112, 160, 217, 221, 223, 185, 21,  237, 53,  11,
         14,  239, 202, 122, 28,  13,  67,  77,  33,  58,  35,  173, 88,  154,
         162, 170, 27,  146, 253, 83,  18,  120, 211, 110, 130, 192, 82,  231,
         38,  42,  224, 240, 72,  40,  210, 228, 235, 5,   85,  96,  166, 153,
         10,  7,   139, 12},
        {188, 18,  16,  157, 92,  7,   235, 194, 60,  195, 21,  71,  95,  187,
         140, 150, 172, 50,  93,  56,  28,  215, 233, 41,  174, 115, 23,  244,
         167, 114, 191, 78,  125, 218, 165, 178, 8,   206, 120, 83,  168, 15,
         164, 224, 70,  44,  85,  88,  94,  229, 250, 132, 122, 62,  124, 17,
         20,  128, 32,  30,  151, 48,  121, 145, 110, 184, 182, 186, 177, 68,
         173, 66,  166, 113, 134, 106, 59,  12,  169, 89,  170, 5,   141, 176,
         180, 217, 61,  230, 205, 232, 247, 209, 152, 9,   112, 81,  156, 82,
         237, 22,  33,  236, 58,  255, 239, 179, 76,  97,  130, 220, 213, 200,
         214, 42,  47,  228, 234, 0,   126, 4,   226, 253, 118, 154, 6,   142,
         222, 175, 139, 80,  75,  87,  53,  231, 27,  46,  135, 246, 26,  100,
         107, 181, 138, 251, 69,  227, 245, 192, 31,  158, 29,  10,  90,  3,
         197, 211, 201, 64,  1,   190, 189, 199, 63,  57,  51,  212, 147, 204,
         39,  163, 14,  24,  40,  202, 221, 123, 143, 54,  91,  103, 241, 37,
         208, 159, 117, 162, 11,  99,  98,  131, 136, 238, 249, 105, 25,  65,
         185, 35,  171, 193, 67,  160, 248, 79,  149, 49,  161, 155, 252, 243,
         216, 198, 45,  109, 101, 240, 116, 144, 55,  104, 36,  133, 254, 153,
         108, 119, 96,  38,  72,  19,  86,  137, 207, 13,  73,  225, 219, 146,
         129, 242, 127, 52,  148, 223, 43,  84,  102, 34,  77,  74,  210, 183,
         2,   111, 203, 196},
        {132, 60,  111, 148, 158, 168, 67,  172, 6,   96,  49,  72,  27,  99,
         191, 0,   64,  104, 21,  212, 51,  207, 240, 131, 208, 209, 57,  251,
         105, 145, 190, 215, 169, 10,  54,  48,  188, 217, 126, 248, 33,  63,
         200, 87,  138, 152, 101, 53,  68,  250, 230, 17,  32,  39,  134, 254,
         202, 15,  241, 218, 222, 73,  16,  18,  13,  100, 133, 50,  118, 246,
         86,  234, 136, 167, 196, 210, 117, 211, 201, 137, 204, 61,  182, 127,
         80,  185, 121, 141, 135, 239, 112, 228, 177, 116, 9,   195, 36,  59,
         252, 58,  143, 44,  81,  224, 173, 62,  128, 170, 31,  153, 184, 28,
         157, 147, 34,  176, 23,  125, 199, 94,  174, 113, 22,  146, 78,  114,
         130, 107, 47,  244, 122, 203, 84,  225, 186, 243, 12,  180, 236, 46,
         124, 98,  189, 165, 255, 120, 242, 88,  77,  156, 192, 69,  151, 119,
         26,  19,  150, 161, 75,  8,   3,   66,  74,  197, 41,  35,  79,  37,
         214, 14,  198, 82,  213, 171, 25,  55,  219, 11,  245, 233, 139, 223,
         40,  89,  93,  193, 24,  175, 108, 194, 216, 221, 92,  178, 187, 65,
         183, 247, 253, 163, 38,  42,  29,  237, 110, 20,  2,   235, 181, 159,
         229, 106, 160, 115, 154, 166, 238, 149, 162, 76,  220, 155, 205, 90,
         4,   30,  227, 144, 52,  70,  142, 226, 179, 123, 45,  95,  91,  1,
         85,  232, 43,  102, 103, 97,  5,   129, 83,  109, 164, 249, 231, 71,
         206, 56,  7,   140},
        {60,  97,  185, 92,  198, 113, 253, 78,  87,  127, 48,  178, 30,  52,
         174, 148, 179, 211, 191, 184, 165, 91,  207, 193, 139, 34,  9,   227,
         230, 194, 19,  111, 173, 89,  171, 153, 4,   172, 249, 95,  45,  162,
         98,  43,  33,  63,  192, 251, 252, 105, 134, 124, 22,  154, 47,  77,
         133, 41,  170, 183, 226, 115, 195, 255, 62,  160, 12,  121, 241, 18,
         146, 225, 208, 180, 238, 69,  118, 212, 237, 84,  144, 205, 235, 150,
         156, 86,  228, 61,  23,  44,  167, 240, 100, 29,  135, 101, 157, 250,
         229, 35,  74,  158, 28,  137, 109, 108, 40,  224, 3,   42,  114, 66,
         140, 57,  232, 159, 82,  112, 223, 187, 129, 218, 116, 209, 181, 190,
         24,  136, 56,  122, 128, 245, 67,  53,  76,  70,  143, 164, 50,  32,
         93,  186, 39,  26,  246, 182, 126, 247, 99,  102, 203, 90,  199, 120,
         197, 210, 189, 117, 59,  68,  219, 16,  1,   94,  138, 37,  236, 49,
         132, 21,  46,  36,  254, 104, 166, 123, 200, 110, 81,  83,  220, 145,
         65,  10,  79,  244, 54,  80,  75,  2,   20,  168, 6,   107, 73,  96,
         163, 243, 5,   72,  231, 88,  188, 15,  242, 239, 14,  11,  213, 130,
         85,  27,  177, 131, 169, 202, 142, 17,  8,   196, 201, 176, 58,  7,
         217, 103, 125, 206, 248, 221, 216, 119, 71,  214, 204, 175, 51,  149,
         147, 161, 222, 234, 0,   215, 64,  152, 55,  13,  25,  155, 106, 151,
         233, 38,  31,  141},
        {15,  4,   147, 204, 176, 72,  253, 45,  69,  248, 114, 165, 154, 166,
         231, 130, 90,  134, 116, 161, 136, 42,  169, 222, 115, 22,  184, 71,
         239, 243, 135, 137, 237, 6,   129, 79,  126, 13,  46,  11,  101, 197,
         14,  160, 224, 104, 233, 201, 96,  23,  155, 28,  232, 145, 120, 212,
         66,  123, 0,   128, 240, 60,  99,  140, 16,  48,  192, 215, 78,  94,
         9,   131, 142, 118, 3,   238, 242, 113, 117, 153, 19,  241, 86,  61,
         106, 141, 190, 107, 34,  18,  210, 39,  227, 167, 82,  33,  175, 88,
         219, 122, 234, 87,  74,  112, 133, 162, 218, 168, 220, 102, 37,  111,
         221, 216, 124, 98,  52,  64,  164, 36,  56,  245, 209, 205, 138, 181,
         177, 213, 211, 173, 75,  143, 179, 127, 252, 92,  191, 8,   29,  67,
         174, 139, 103, 178, 77,  207, 250, 255, 229, 108, 65,  193, 236, 76,
         12,  5,   105, 244, 38,  35,  30,  200, 40,  171, 172, 214, 182, 158,
         159, 10,  21,  58,  217, 157, 163, 208, 89,  146, 180, 230, 32,  53,
         196, 225, 149, 170, 47,  188, 249, 148, 206, 24,  85,  183, 151, 121,
         80,  81,  62,  41,  202, 93,  91,  83,  156, 100, 195, 223, 150, 226,
         20,  2,   110, 95,  84,  247, 27,  189, 43,  199, 235, 68,  17,  25,
         119, 49,  254, 194, 73,  57,  54,  1,   251, 51,  228, 203, 186, 246,
         198, 31,  187, 132, 63,  185, 109, 125, 50,  55,  144, 152, 97,  7,
         26,  44,  59,  70},
        {113, 241, 49,  28,  199, 222, 171, 210, 41,  166, 251, 63,  142, 147,
         111, 52,  197, 245, 186, 96,  227, 67,  236, 55,  106, 192, 184, 235,
         143, 128, 33,  95,  211, 219, 21,  203, 160, 228, 74,  130, 223, 102,
         109, 5,   154, 65,  172, 81,  250, 198, 13,  165, 162, 15,  247, 17,
         77,  34,  163, 124, 118, 25,  216, 220, 59,  36,  173, 30,  75,  62,
         175, 121, 123, 114, 134, 140, 19,  61,  90,  168, 97,  37,  66,  50,
         98,  144, 244, 195, 146, 224, 100, 202, 103, 156, 193, 38,  170, 157,
         44,  252, 45,  18,  58,  145, 141, 51,  1,   125, 243, 187, 129, 215,
         237, 116, 151, 0,   35,  48,  88,  120, 178, 6,   231, 107, 8,   148,
         180, 20,  4,   27,  112, 85,  26,  86,  137, 64,  164, 40,  60,  31,
         46,  194, 92,  246, 29,  174, 150, 135, 155, 22,  83,  73,  132, 24,
         206, 127, 253, 119, 7,   204, 152, 91,  190, 225, 149, 57,  42,  177,
         71,  93,  205, 158, 167, 56,  3,   218, 240, 234, 230, 238, 249, 221,
         39,  153, 248, 196, 80,  159, 131, 11,  254, 101, 226, 47,  191, 117,
         188, 176, 208, 212, 122, 189, 110, 2,   9,   209, 233, 255, 79,  89,
         78,  70,  242, 99,  217, 84,  169, 214, 68,  108, 201, 239, 82,  182,
         136, 181, 53,  183, 126, 16,  87,  69,  72,  105, 207, 12,  43,  161,
         229, 76,  32,  54,  23,  14,  179, 115, 138, 200, 10,  185, 104, 213,
         232, 139, 133, 94},
    },
    {
        {72,  201, 69,  0,   61,  170, 9,   230, 186, 34,  193, 183, 70,  218,
         194, 54,  63,  246, 22,  228, 150, 232, 57,  67,  122, 197, 190, 231,
         166, 165, 42,  32,  237, 13,  203, 105, 207, 103, 39,  213, 221, 3,
         47,  80,  106, 182, 111, 1,   149, 157, 123, 108, 12,  18,  199, 94,
         233, 38,  171, 167, 104, 98,  145, 71,  133, 40,  160, 65,  127, 115,
         124, 109, 219, 196, 187, 155, 177, 101, 229, 143, 28,  64,  96,  33,
         240, 60,  51,  173, 216, 19,  114, 17,  2,   189, 128, 249, 198, 159,
         85,  220, 77,  92,  10,  253, 89,  88,  100, 191, 91,  37,  130, 188,
         62,  242, 31,  8,   254, 181, 7,   66,  225, 148, 163, 23,  137, 21,
         82,  209, 245, 119, 140, 152, 255, 73,  24,  116, 113, 176, 250, 50,
         248, 146, 223, 239, 192, 99,  59,  78,  110, 211, 125, 84,  27,  55,
         132, 16,  43,  14,  56,  241, 20,  184, 204, 118, 236, 121, 205, 252,
         48,  53,  139, 247, 195, 36,  87,  11,  120, 126, 49,  251, 243, 35,
         222, 76,  29,  52,  164, 178, 226, 168, 141, 74,  58,  144, 102, 6,
         83,  235, 90,  134, 46,  107, 129, 214, 44,  117, 138, 217, 180, 238,
         75,  210, 135, 185, 151, 215, 112, 79,  142, 95,  81,  174, 5,   161,
         4,   131, 97,  15,  200, 25,  244, 154, 179, 175, 208, 224, 202, 212,
         136, 86,  26,  162, 206, 158, 172, 234, 147, 153, 30,  68,  41,  156,
         45,  227, 169, 93},
        {255, 221, 243, 157, 134, 246, 197, 163, 230, 55,  96,  95,  130, 49,
         227, 27,  147, 42,  48,  202, 45,  122, 90,  224, 53,  15,  150, 47,
         94,  113, 82,  200, 215, 209, 35,  83,  73,  67,  12,  135, 216, 19,
         186, 88,  189, 244, 167, 210, 174, 123, 79,  179, 138, 41,  236, 191,
         184, 232, 43,  141, 39,  66,  85,  175, 102, 25,  152, 29,  128, 26,
         254, 154, 64,  164, 173, 70,  10,  74,  252, 178, 250, 172, 33,  196,
         170, 129, 120, 78,  65,  251, 107, 240, 108, 63,  180, 117, 40,  24,
         187, 115, 144, 5,   110, 81,  69,  119, 231, 71,  198, 165, 75,  97,
         17,  162, 6,   4,   58,  60,  212, 131, 32,  146, 148, 37,  248, 193,
         56,  190, 222, 192, 80,  211, 218, 99,  201, 199, 46,  92,  13,  114,
         50,  127, 1,   168, 208, 133, 219, 121, 109, 195, 239, 59,  207, 156,
         125, 233, 8,   169, 31,  160, 103, 51,  213, 145, 253, 105, 155, 57,
         44,  206, 247, 9,   11,  234, 111, 161, 14,  171, 185, 84,  116, 76,
         249, 177, 28,  158, 124, 214, 104, 188, 118, 159, 151, 3,   22,  166,
         241, 238, 126, 217, 89,  137, 176, 91,  225, 54,  68,  21,  204, 229,
         226, 100, 7,   34,  182, 235, 62,  228, 101, 220, 203, 98,  30,  72,
         136, 223, 153, 87,  23,  181, 86,  36,  183, 112, 142, 61,  139, 106,
         242, 77,  205, 143, 194, 140, 38,  93,  20,  132, 2,   52,  18,  245,
         16,  149, 237, 0},
        {221, 210, 88,  178, 229, 239, 33,  81,  201, 136, 108, 196, 143, 63,
         106, 148, 37,  145, 177, 172, 132, 213, 243, 102, 97,  232, 173, 100,
         3,   235, 144, 59,  156, 76,  151, 242, 238, 154, 209, 115, 121, 237,
         126, 58,  190, 13,  53,  103, 6,   188, 159, 152, 186, 248, 39,  95,
         135, 67,  168, 224, 170, 7,   11,  38,  64,  25,  184, 55,  99,  31,
         195, 155, 93,  153, 134, 171, 114, 149, 40,  194, 61,  181, 142, 253,
         183, 216, 16,  65,  68,  164, 113, 50,  77,  193, 146, 215, 84,  120,
         85,  105, 227, 199, 101, 104, 233, 51,  161, 220, 125, 231, 42,  118,
         66,  27,  236, 30,  226, 110, 255, 4,   34,  176, 23,  162, 124, 214,
         223, 49,  15,  122, 247, 147, 92,  207, 254, 197, 109, 5,   21,  89,
         18,  140, 217, 211, 116, 9,   46,  60,  57,  86,  8,   180, 75,  107,
         246, 48,  252, 222, 111, 244, 74,  69,  24,  17,  241, 150, 228, 14,
         127, 230, 73,  250, 62,  56,  192, 212, 139, 225, 29,  138, 94,  41,
         189, 204, 200, 129, 26,  157, 218, 71,  83,  208, 141, 234, 117, 78,
         166, 191, 79,  128, 185, 82,  158, 0,   47,  131, 35,  87,  163, 54,
         249, 22,  12,  133, 167, 245, 90,  203, 169, 240, 219, 174, 160, 45,
         96,  98,  119, 32,  130, 80,  137, 202, 2,   28,  72,  20,  165, 70,
         10,  44,  19,  123, 91,  182, 251, 1,   52,  179, 36,  206, 198, 187,
         175, 112, 43,  205},
        {245, 210, 21,  226, 63,  197, 171, 228, 241, 86,  40,  74,  57,  65,
         66,  195, 15,  88,  89,  182, 122, 134, 161, 229, 198, 193, 157, 62,
         219, 246, 124, 230, 213, 127, 232, 92,  249, 115, 78,  87,  120, 99,
         152, 253, 206, 147, 123, 173, 47,  167, 203, 224, 9,   94,  28,  209,
         179, 72,  50,  104, 49,  12,  185, 8,   172, 237, 84,  103, 136, 168,
         170, 156, 233, 58,  13,  155, 252, 239, 79,  160, 236, 29,  125, 100,
         90,  166, 177, 97,  6,   22,  119, 178, 188, 18,  46,  235, 1,   26,
         187, 150, 19,  23,  32,  242, 20,  38,  174, 164, 163, 118, 85,  48,
         133, 200, 251, 111, 95,  116, 153, 121, 190, 98,  102, 51,  55,  7,
         117, 148, 183, 202, 16,  17,  83,  71,  154, 144, 70,  3,   137, 39,
         54,  204, 159, 132, 82,  208, 34,  255, 194, 199, 220, 186, 142, 181,
         126, 80,  139, 45,  64,  231, 30,  75,  4,   35,  109, 67,  110, 218,
         0,   205, 212, 141, 60,  184, 76,  165, 143, 41,  44,  14,  129, 33,
         149, 248, 37,  189, 175, 215, 240, 196, 223, 254, 169, 130, 31,  112,
         81,  43,  158, 36,  243, 27,  244, 24,  131, 135, 211, 53,  52,  101,
         217, 25,  191, 77,  227, 221, 5,   138, 114, 93,  10,  180, 207, 68,
         176, 216, 247, 140, 146, 225, 107, 2,   105, 59,  201, 91,  106, 192,
         56,  151, 113, 238, 11,  61,  162, 214, 42,  234, 73,  250, 222, 69,
         145, 96,  128, 108},
        {51,  139, 96,  8,   184, 30,  233, 65,  36,  126, 251, 205, 226, 130,
         187, 245, 145, 74,  180, 136, 254, 87,  214, 201, 100, 217, 216, 104,
         20,  111, 18,  210, 86,  119, 193, 17,  246, 129, 57,  25,  27,  84,
         35,  120, 147, 50,  99,  70,  110, 21,  154, 197, 54,  171, 105, 64,
         116, 93,  16,  143, 73,  185, 15,  89,  108, 240, 88,  218, 52,  114,
         166, 150, 94,  127, 107, 215, 10,  72,  40,  106, 92,  67,  202, 138,
         206, 244, 164, 229, 134, 47,  191, 132, 45,  117, 220, 198, 68,  213,
         158, 189, 225, 252, 6,   85,  230, 224, 144, 122, 98,  53,  228, 80,
         219, 161, 71,  23,  83,  97,  137, 155, 128, 243, 42,  211, 118, 165,
         9,   91,  152, 24,  113, 135, 90,  44,  81,  12,  238, 232, 5,   188,
         75,  95,  177, 159, 37,  102, 160, 250, 101, 55,  76,  200, 199, 14,
         62,  109, 203, 209, 142, 146, 148, 186, 3,   125, 28,  33,  34,  167,
         26,  236, 242, 223, 11,  207, 7,   41,  4,   169, 141, 156, 253, 149,
         19,  182, 123, 248, 48,  237, 221, 178, 173, 115, 58,  235, 22,  234,
         43,  151, 46,  170, 133, 153, 66,  0,   39,  1,   247, 192, 172, 249,
         140, 190, 194, 121, 204, 59,  175, 69,  163, 32,  31,  29,  174, 157,
         162, 56,  212, 112, 176, 78,  2,   181, 38,  63,  239, 168, 208, 61,
         227, 222, 231, 131, 124, 77,  103, 183, 49,  179, 82,  241, 60,  195,
         79,  196, 13,  255},
        {83,  177, 34,  114, 240, 218, 39,  48,  241, 235, 16,  87,  196, 140,
         166, 158, 58,  44,  51,  220, 139, 74,  182, 93,  208, 138, 4,   10,
         110, 236, 186, 127, 145, 54,  105, 65,  245, 59,  97,  226, 40,  19,
         53,  20,  119, 0,   188, 23,  104, 27,  121, 244, 86,  176, 172, 248,
         106, 22,  120, 216, 171, 209, 118, 8,   227, 183, 215, 88,  26,  197,
         41,  77,  134, 69,  136, 252, 201, 131, 251, 90,  29,  194, 191, 108,
         143, 45,  63,  25,  79,  155, 129, 132, 102, 42,  126, 156, 193, 13,
         189, 17,  68,  198, 117, 212, 84,  47,  246, 73,  92,  135, 64,  217,
         150, 85,  165, 164, 160, 200, 78,  233, 11,  169, 159, 70,  50,  230,
         1,   187, 231, 75,  232, 67,  57,  141, 32,  144, 163, 243, 228, 192,
         52,  6,   133, 184, 96,  116, 5,   247, 181, 255, 112, 3,   130, 168,
         203, 98,  148, 137, 113, 80,  12,  161, 61,  2,   101, 123, 219, 225,
         109, 238, 28,  152, 89,  239, 211, 66,  249, 179, 142, 229, 174, 147,
         173, 72,  190, 49,  254, 82,  153, 234, 162, 81,  154, 24,  30,  185,
         205, 125, 56,  213, 38,  151, 62,  214, 60,  157, 71,  224, 128, 76,
         124, 237, 180, 107, 222, 223, 221, 33,  55,  94,  210, 175, 15,  122,
         43,  111, 31,  21,  178, 170, 115, 91,  95,  36,  146, 242, 99,  149,
         37,  14,  207, 167, 103, 199, 202, 18,  9,   204, 253, 35,  100, 7,
         195, 250, 206, 46},
        {23,  155, 75,  125, 59,  40,  57,  154, 156, 74,  222, 205, 104, 220,
         3,   50,  1,   238, 52,  129, 231, 151, 69,  177, 153, 132, 31,  181,
         93,  112, 203, 120, 22,  99,  79,  211, 44,  236, 234, 221, 170, 225,
         251, 233, 127, 18,  46,  0,   35,  140, 51,  180, 252, 113, 37,  48,
         128, 72,  182, 235, 119, 105, 148, 165, 247, 100, 115, 25,  7,   83,
         55,  80,  150, 212, 9,   139, 53,  245, 20,  237, 102, 190, 226, 173,
         19,  91,  118, 144, 94,  5,   192, 17,  239, 110, 108, 6,   66,  49,
         2,   198, 38,  62,  73,  121, 188, 164, 126, 219, 171, 41,  209, 254,
         89,  116, 10,  8,   158, 81,  191, 216, 32,  24,  210, 87,  88,  163,
         227, 228, 26,  97,  147, 160, 199, 76,  143, 98,  34,  21,  217, 174,
         215, 28,  68,  207, 169, 11,  229, 29,  61,  16,  47,  248, 27,  114,
         184, 15,  145, 196, 176, 193, 85,  167, 149, 224, 84,  92,  82,  223,
         178, 250, 189, 133, 109, 214, 70,  135, 54,  141, 206, 58,  186, 36,
         42,  242, 136, 65,  218, 138, 78,  95,  162, 117, 77,  243, 213, 106,
         240, 43,  194, 232, 253, 67,  255, 175, 157, 4,   201, 122, 152, 230,
         146, 103, 183, 208, 96,  187, 123, 30,  45,  244, 249, 124, 71,  137,
         246, 168, 134, 202, 14,  131, 200, 60,  161, 179, 204, 39,  241, 90,
         159, 142, 63,  197, 111, 166, 12,  101, 86,  56,  195, 107, 130, 172,
         33,  64,  185, 13},
        {1,   192, 45,  12,  238, 199, 162, 128, 82,  148, 151, 216, 31,  80,
         58,  83,  2,   103, 175, 64,  77,  33,  159, 70,  121, 35,  193, 126,
         76,  99,  132, 138, 41,  251, 15,  113, 188, 201, 171, 214, 98,  17,
         143, 191, 104, 6,   19,  107, 52,  111, 5,   44,  145, 196, 172, 160,
         55,  149, 134, 59,  14,  110, 30,  241, 168, 198, 131, 8,   23,  182,
         91,  48,  167, 109, 152, 245, 117, 218, 75,  21,  142, 228, 36,  248,
         119, 86,  203, 137, 105, 140, 87,  39,  180, 206, 195, 202, 102, 72,
         235, 84,  209, 153, 116, 161, 233, 224, 222, 47,  197, 164, 28,  139,
         123, 207, 94,  73,  38,  226, 242, 215, 106, 220, 26,  122, 22,  93,
         68,  11,  229, 89,  129, 154, 62,  254, 124, 65,  25,  189, 183, 43,
         56,  219, 32,  157, 78,  118, 101, 115, 232, 24,  179, 53,  169, 255,
         49,  79,  133, 81,  127, 144, 239, 57,  247, 208, 252, 54,  147, 61,
         204, 74,  253, 46,  165, 174, 96,  223, 190, 185, 69,  210, 37,  108,
         186, 40,  10,  163, 27,  176, 205, 184, 20,  67,  194, 3,   249, 240,
         13,  0,   4,   34,  18,  217, 112, 141, 246, 173, 237, 7,   97,  90,
         85,  250, 16,  178, 9,   100, 227, 50,  212, 230, 211, 177, 244, 51,
         200, 243, 114, 88,  170, 135, 66,  136, 234, 166, 42,  221, 95,  60,
         225, 71,  150, 158, 29,  92,  213, 120, 156, 130, 63,  187, 231, 236,
         146, 125, 155, 181},
    },
    {{239, 11,  166, 0,   142, 82,  189, 219, 52,  195, 231, 120, 154, 123, 96,
      33,  36,  199, 164, 169, 79,  25,  217, 171, 232, 46,  24,  101, 112, 223,
      100, 213, 236, 28,  149, 147, 247, 49,  40,  140, 111, 208, 248, 63,  181,
      200, 148, 234, 88,  10,  18,  86,  75,  45,  204, 55,  251, 70,  50,  205,
      176, 117, 113, 57,  162, 104, 43,  121, 116, 218, 249, 186, 5,   64,  240,
      12,  90,  97,  84,  135, 27,  198, 210, 77,  150, 7,   20,  37,  225, 95,
      44,  161, 32,  81,  253, 132, 65,  8,   226, 165, 21,  193, 146, 133, 207,
      136, 93,  41,  76,  138, 80,  51,  85,  192, 71,  26,  152, 103, 202, 233,
      23,  16,  134, 175, 155, 73,  13,  229, 221, 129, 108, 4,   191, 163, 180,
      241, 227, 125, 168, 130, 131, 188, 31,  38,  35,  34,  194, 141, 254, 42,
      245, 128, 127, 39,  62,  216, 201, 118, 53,  203, 61,  172, 92,  69,  122,
      47,  114, 159, 105, 29,  173, 9,   222, 252, 178, 94,  244, 160, 107, 156,
      179, 145, 67,  48,  144, 182, 157, 211, 110, 78,  237, 87,  19,  98,  212,
      246, 115, 58,  184, 119, 124, 177, 228, 109, 196, 3,   243, 197, 143, 250,
      54,  242, 126, 220, 167, 235, 170, 59,  106, 137, 238, 66,  158, 214, 255,
      6,   190, 102, 151, 187, 153, 74,  14,  72,  185, 139, 30,  215, 83,  2,
      174, 56,  89,  22,  91,  209, 224, 68,  60,  230, 1,   15,  99,  206, 17,
      183},
     {177, 83,  87,  210, 24,  64,  127, 237, 99,  243, 242, 209, 48,  167, 54,
      20,  251, 147, 253, 198, 139, 124, 189, 141, 150, 108, 146, 222, 125, 58,
      234, 182, 169, 94,  68,  129, 143, 116, 207, 130, 52,  250, 9,   70,  132,
      104, 19,  193, 137, 29,  47,  155, 178, 88,  180, 35,  3,   43,  0,   164,
      233, 238, 168, 15,  131, 17,  133, 2,   181, 162, 118, 36,  241, 42,  126,
      173, 60,  28,  163, 240, 247, 196, 95,  121, 192, 195, 225, 239, 249, 51,
      77,  135, 12,  255, 11,  31,  66,  153, 50,  156, 71,  18,  80,  175, 236,
      235, 34,  30,  166, 158, 145, 112, 113, 120, 204, 188, 197, 33,  37,  16,
      211, 223, 21,  67,  229, 165, 184, 44,  244, 14,  203, 138, 4,   117, 122,
      106, 224, 27,  246, 159, 149, 214, 39,  154, 100, 26,  81,  206, 5,   57,
      74,  176, 73,  212, 63,  41,  62,  157, 102, 55,  185, 208, 171, 56,  22,
      202, 218, 69,  194, 228, 49,  248, 201, 128, 115, 119, 191, 161, 217, 183,
      245, 90,  160, 220, 7,   200, 96,  85,  142, 151, 76,  103, 65,  215, 93,
      205, 105, 136, 216, 59,  25,  107, 98,  187, 231, 172, 226, 72,  23,  144,
      219, 92,  101, 152, 79,  91,  227, 45,  174, 86,  170, 232, 109, 10,  97,
      32,  213, 221, 199, 114, 53,  40,  6,   148, 46,  13,  111, 140, 84,  38,
      190, 134, 123, 89,  1,   82,  8,   110, 179, 254, 186, 252, 78,  75,  230,
      61},
     {72,  190, 146, 112, 209, 69,  47,  198, 84,  202, 138, 114, 127, 8,   162,
      136, 77,  102, 58,  41,  242, 89,  230, 16,  200, 232, 243, 217, 88,  164,
      36,  132, 188, 75,  59,  180, 87,  150, 175, 170, 163, 151, 32,  123, 9,
      143, 214, 224, 157, 44,  14,  54,  49,  111, 66,  25,  219, 161, 247, 223,
      229, 50,  99,  83,  43,  119, 249, 135, 185, 174, 61,  207, 101, 192, 35,
      148, 45,  97,  27,  183, 173, 63,  181, 189, 94,  133, 208, 199, 104, 179,
      144, 82,  96,  250, 57,  187, 245, 149, 7,   13,  73,  130, 109, 30,  0,
      251, 168, 42,  113, 4,   142, 139, 141, 154, 56,  226, 38,  60,  160, 118,
      194, 128, 228, 65,  212, 213, 107, 22,  182, 172, 48,  201, 110, 70,  106,
      218, 225, 152, 131, 166, 20,  2,   158, 80,  55,  178, 23,  177, 134, 125,
      37,  240, 244, 203, 105, 237, 33,  92,  145, 236, 176, 115, 252, 165, 205,
      248, 167, 171, 78,  95,  220, 29,  126, 86,  15,  193, 68,  215, 98,  197,
      156, 116, 11,  169, 62,  129, 234, 12,  85,  1,   233, 155, 191, 204, 6,
      122, 121, 184, 231, 74,  140, 19,  117, 227, 21,  103, 159, 238, 153, 254,
      196, 24,  93,  120, 235, 64,  51,  17,  26,  186, 241, 137, 210, 46,  67,
      222, 246, 3,   100, 28,  81,  206, 221, 216, 90,  31,  40,  39,  108, 79,
      18,  71,  52,  239, 195, 253, 53,  124, 255, 34,  91,  211, 5,   10,  76,
      147},
     {119, 36,  80,  171, 188, 189, 94,  42,  162, 32,  52,  195, 135, 110, 30,
      113, 203, 73,  215, 112, 92,  100, 86,  99,  122, 75,  24,  130, 154, 81,
      76,  22,  255, 12,  41,  11,  89,  102, 224, 10,  40,  149, 230, 253, 244,
      28,  114, 216, 241, 251, 165, 128, 247, 101, 129, 143, 147, 88,  2,   252,
      87,  71,  221, 9,   190, 234, 137, 111, 5,   117, 134, 61,  106, 8,   62,
      231, 208, 235, 132, 4,   164, 201, 19,  177, 1,   170, 23,  199, 167, 91,
      38,  225, 68,  237, 65,  157, 138, 107, 39,  79,  96,  127, 72,  43,  178,
      60,  83,  14,  229, 166, 233, 202, 172, 55,  168, 67,  174, 155, 103, 158,
      142, 90,  116, 187, 238, 126, 242, 183, 173, 7,   236, 51,  37,  50,  121,
      153, 200, 15,  54,  194, 44,  0,   186, 198, 141, 181, 118, 97,  108, 197,
      85,  105, 232, 191, 219, 56,  207, 240, 246, 25,  45,  115, 243, 47,  217,
      98,  179, 139, 196, 175, 66,  214, 34,  31,  156, 169, 18,  74,  206, 222,
      144, 59,  125, 13,  109, 70,  227, 46,  35,  250, 205, 161, 223, 16,  192,
      33,  220, 211, 6,   84,  21,  49,  63,  176, 104, 159, 26,  254, 20,  160,
      193, 228, 69,  185, 78,  212, 180, 58,  148, 29,  3,   150, 146, 53,  209,
      77,  27,  204, 140, 124, 64,  48,  249, 17,  163, 245, 82,  136, 213, 93,
      218, 123, 210, 151, 131, 182, 120, 145, 184, 57,  152, 133, 248, 239, 95,
      226},
     {34,  16,  117, 76,  115, 15,  7,   124, 213, 22,  100, 119, 248, 246, 68,
      74,  163, 197, 65,  189, 56,  36,  57,  86,  183, 121, 128, 222, 29,  231,
      83,  173, 11,  37,  26,  9,   28,  186, 62,  240, 176, 85,  177, 138, 103,
      63,  201, 55,  139, 110, 149, 48,  156, 1,   215, 81,  144, 30,  232, 70,
      251, 108, 148, 35,  223, 208, 47,  166, 72,  71,  193, 196, 233, 101, 165,
      227, 220, 245, 52,  194, 38,  2,   238, 187, 195, 158, 18,  133, 107, 12,
      155, 205, 191, 0,   206, 49,  90,  218, 182, 80,  153, 142, 188, 198, 152,
      217, 235, 59,  123, 234, 51,  96,  102, 254, 141, 168, 162, 164, 185, 143,
      87,  192, 199, 109, 88,  127, 93,  44,  31,  253, 84,  154, 50,  5,   99,
      41,  6,   170, 122, 237, 216, 229, 179, 190, 169, 178, 73,  45,  46,  249,
      61,  230, 114, 136, 226, 203, 130, 172, 118, 255, 157, 134, 241, 60,  204,
      79,  159, 181, 214, 95,  58,  94,  242, 3,   129, 104, 13,  113, 212, 137,
      27,  10,  64,  120, 174, 78,  247, 209, 97,  175, 161, 125, 111, 252, 180,
      146, 210, 82,  112, 43,  23,  145, 92,  69,  33,  98,  236, 132, 8,   42,
      167, 171, 221, 21,  250, 53,  184, 89,  200, 135, 25,  32,  244, 54,  202,
      239, 24,  67,  75,  105, 116, 4,   77,  147, 126, 228, 66,  211, 17,  243,
      106, 150, 151, 14,  160, 40,  91,  20,  224, 140, 19,  225, 131, 219, 207,
      39},
     {156, 25,  111, 197, 95,  87,  174, 65,  115, 163, 249, 251, 182, 57,  220,
      49,  40,  155, 173, 178, 98,  43,  47,  48,  153, 233, 170, 149, 244, 103,
      221, 216, 99,  91,  89,  83,  214, 208, 71,  242, 241, 157, 247, 24,  41,
      122, 102, 21,  255, 88,  185, 138, 142, 181, 80,  139, 234, 54,  33,  30,
      199, 31,  180, 73,  144, 11,  107, 39,  59,  125, 227, 110, 42,  239, 179,
      7,   210, 145, 50,  129, 123, 101, 202, 166, 60,  228, 232, 252, 160, 46,
      141, 86,  162, 183, 128, 130, 94,  113, 134, 79,  152, 161, 223, 245, 104,
      171, 6,   121, 198, 61,  29,  78,  209, 158, 9,   246, 70,  146, 164, 45,
      175, 224, 147, 172, 176, 131, 75,  127, 108, 235, 13,  243, 194, 106, 189,
      34,  200, 52,  191, 186, 92,  240, 58,  114, 69,  169, 14,  254, 18,  222,
      250, 120, 116, 154, 132, 231, 212, 81,  84,  229, 225, 135, 118, 211, 151,
      72,  20,  248, 51,  76,  97,  253, 90,  215, 53,  201, 159, 38,  74,  68,
      119, 195, 1,   226, 196, 77,  137, 237, 27,  66,  10,  206, 19,  22,  109,
      219, 100, 2,   193, 64,  148, 205, 44,  15,  203, 184, 136, 188, 96,  35,
      67,  5,   85,  0,   36,  105, 177, 55,  56,  217, 26,  207, 8,   187, 16,
      190, 117, 37,  63,  218, 23,  165, 167, 204, 126, 62,  150, 112, 230, 133,
      140, 93,  82,  4,   28,  238, 143, 12,  124, 192, 213, 3,   32,  168, 17,
      236},
     {85,  57,  210, 212, 191, 193, 45,  239, 42,  60,  86,  198, 241, 115, 246,
      251, 230, 186, 103, 163, 99,  127, 87,  244, 172, 44,  37,  111, 89,  141,
      105, 26,  126, 84,  67,  145, 4,   168, 221, 119, 242, 147, 124, 236, 48,
      247, 196, 149, 166, 76,  182, 250, 177, 181, 82,  116, 142, 223, 243, 109,
      155, 12,  47,  95,  183, 78,  164, 135, 192, 14,  167, 51,  70,  131, 74,
      174, 25,  148, 101, 229, 2,   22,  203, 140, 207, 72,  117, 144, 222, 133,
      108, 33,  205, 227, 94,  216, 150, 50,  56,  158, 194, 187, 49,  217, 184,
      61,  128, 64,  197, 188, 240, 97,  7,   175, 104, 249, 54,  40,  123, 5,
      28,  154, 180, 139, 112, 206, 100, 199, 35,  248, 16,  38,  83,  160, 232,
      17,  114, 211, 162, 234, 79,  202, 52,  173, 200, 118, 233, 66,  152, 134,
      73,  213, 62,  13,  159, 41,  58,  93,  39,  121, 18,  138, 65,  253, 6,
      122, 11,  88,  90,  153, 169, 63,  219, 69,  165, 59,  10,  245, 171, 214,
      106, 176, 92,  235, 208, 46,  20,  185, 9,   204, 36,  29,  218, 179, 161,
      107, 178, 71,  91,  34,  19,  136, 32,  24,  125, 8,   31,  43,  151, 231,
      156, 98,  75,  224, 157, 238, 252, 0,   30,  110, 21,  170, 237, 220, 113,
      68,  77,  226, 189, 27,  55,  143, 195, 120, 255, 190, 225, 201, 215, 23,
      137, 15,  254, 80,  53,  81,  102, 132, 96,  228, 129, 3,   209, 146, 1,
      130},
     {8,   82,  228, 84,  76,  208, 205, 250, 190, 233, 141, 238, 1,   56,  109,
      74,  19,  148, 57,  178, 182, 32,  248, 240, 162, 247, 97,  104, 110, 197,
      224, 105, 157, 66,  145, 62,  116, 96,  80,  151, 49,  171, 147, 130, 58,
      68,  204, 22,  114, 115, 143, 123, 241, 81,  176, 175, 88,  125, 53,  99,
      189, 18,  140, 213, 167, 12,  243, 199, 217, 48,  226, 7,   36,  15,  170,
      55,  118, 20,  237, 137, 25,  50,  14,  142, 225, 17,  146, 40,  227, 246,
      149, 27,  206, 198, 252, 71,  174, 103, 229, 111, 187, 166, 165, 70,  231,
      179, 184, 222, 223, 47,  119, 214, 85,  78,  39,  177, 133, 23,  183, 181,
      173, 155, 253, 168, 29,  13,  218, 100, 9,   94,  54,  41,  139, 35,  89,
      216, 51,  63,  138, 127, 4,   192, 69,  5,   132, 158, 136, 44,  42,  34,
      46,  196, 207, 86,  180, 31,  52,  128, 153, 75,  121, 202, 254, 220, 150,
      113, 161, 108, 236, 65,  98,  144, 37,  106, 172, 215, 135, 245, 212, 156,
      11,  72,  33,  191, 77,  152, 21,  203, 211, 209, 159, 91,  83,  163, 59,
      45,  201, 249, 244, 160, 3,   24,  10,  67,  120, 131, 186, 239, 112, 126,
      235, 107, 188, 129, 134, 200, 124, 61,  79,  251, 73,  30,  221, 101, 230,
      194, 164, 169, 87,  193, 90,  16,  26,  2,   219, 28,  117, 242, 38,  60,
      64,  122, 92,  102, 185, 43,  93,  195, 6,   210, 255, 232, 0,   154, 95,
      234}}};

// State mix function 128 bit -> 128 bit
static inline
void mix(uint64_t *s64, const sbox_t box1, const sbox_t box2) {
  uint8_t q[16];               // 128 bit
  uint64_t *t = (uint64_t*)q;
  uint8_t *s8 = (uint8_t*)s64; // 128 bit
  int counter = 0;
  for (int i = 0; i < 8; i++) {
    uint8_t c = s8[i] + counter;
    q[i] = box1[i][c];
    counter += q[i];
  }
  for (int i = 8; i < 16; i++) {
    uint8_t c = s8[i] + q[i-8];
    q[i] = box2[i-8][c];
  }
  s64[0] = t[1];
  s64[1] = t[0];
}

static inline
void round_fn(uint64_t *state64, const uint64_t *m64, const int len) {
  uint32_t *state32 = (uint32_t *)state64;
  uint32_t *m32 = (uint32_t *)m64;
  for (int i = 0; i < len / 4; i++) {
    state32[i % 4] ^= m32[i];
    if ((i & 3) == 0 && i != 0)
      mix (state64, S[0], S[1]);
  }
  mix (state64, S[2], S[3]);
}

uint64_t beamsplitter(const uint8_t *key, const int len, const uint64_t seed) {
  const uint64_t seed64[2] = {seed, seed};
  const uint64_t *key64 = (uint64_t *)key;
  uint64_t state64[2] = {0L, 0L};

  round_fn (state64, seed64, 16);
  round_fn (state64, key64, len);
  round_fn (state64, seed64, 16);
  round_fn (state64, key64, len);

  return *(uint64_t*)state64;
}
